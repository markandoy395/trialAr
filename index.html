<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-ar@3.4.7/dist/aframe-ar.min.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
    >
      <a-camera gps-camera rotation-reader></a-camera>
    </a-scene>

    <script>
      const targetLat = 8.634762952452858;
      const targetLng = 126.09463667599752;
      const tolerance = 0.0005; // ~50m radius

      function addPlace(lat, lng) {
        const scene = document.querySelector('a-scene');

        const image = document.createElement('a-image');
        image.setAttribute('src', 'https://cdn-icons-png.flaticon.com/512/854/854878.png');
        image.setAttribute('look-at', '[gps-camera]'); 
        image.setAttribute('scale', '20 20 20');
        image.setAttribute('gps-entity-place', `latitude: ${lat}; longitude: ${lng}`);
        scene.appendChild(image);
      }

      // Get device location
      if (navigator.geolocation) {
        navigator.geolocation.watchPosition(success, error, {
          enableHighAccuracy: true,
          maximumAge: 10000,
          timeout: 10000
        });
      } else {
        alert("Geolocation not supported.");
      }

      function success(pos) {
        const lat = pos.coords.latitude;
        const lng = pos.coords.longitude;

        console.log("Your location:", lat, lng);

        if (Math.abs(lat - targetLat) < tolerance &&
            Math.abs(lng - targetLng) < tolerance) {
          // Add AR marker only when near location
          addPlace(targetLat, targetLng);
        }
      }

      function error(err) {
        console.warn("ERROR(" + err.code + "): " + err.message);
      }
    </script>
  </body>
</html>
